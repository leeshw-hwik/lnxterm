# LnxTerm 프로그램 요구사항

## 버전
- 현재 작업 대상: **v1.10.0**

## 시리얼 통신
- ST-Link V3 Mini 기반 임베디드 장치 연결
- 포트 스캔: `/dev/ttyACM*`, `/dev/ttyUSB*`
- 라인 종료 문자: LF (`\n`)
- 포트 점유 감지:
  - Lockfile (`/var/lock/LCK..*`)
  - `fuser`/`lsof`
  - `exclusive=True` (`TIOCEXCL`)
- 비정상 연결 종료 시 자동 재연결
  - 주기 설정: `RECONNECT_INTERVAL_MS` 또는 `RECONNECT_INTERVAL_SEC`
  - 환경변수 미설정/오입력 시 기본 1초

## 환경변수(.env)
- `.env` 로드 우선순위:
  1. 실행 파일 디렉토리 (`dist/lnxterm`와 같은 경로)
  2. 현재 작업 디렉토리
  3. 소스 디렉토리
- `.env` 파일이 없으면 실행 환경에 맞는 경로로 자동 생성
- 최초 자동 생성 시 기본값:
  - `RECONNECT_INTERVAL_MS=1000`
  - `AUTO_LOAD_STRING_STATS=`
  - `AUTO_LOAD_AUTO_COMMANDS=`
  - `AUTO_LOAD_MACRO_COMMANDS=`
- 프로그램 종료 시 환경변수 자동 저장
- 문자열 통계/자동 명령/매크로 변경 시 즉시 `.env` 반영
- `.env`는 git 커밋 금지

## 다국어/언어 설정
- 지원 언어: 한국어(`ko`), 영어(`en`)
- 사용자가 메뉴 `Language`에서 전환 가능
- 언어 설정은 `QSettings`에 저장
- **첫 실행 기본 언어는 영어(`en`)**
- 언어 전환 시 메뉴/사이드바/다이얼로그/검색 UI가 즉시 갱신되어야 함

## 메뉴/테마 가독성
- 메뉴 선택 시 텍스트가 배경과 겹쳐 보이지 않도록 대비 보장
- Visual Studio Code Dark 계열에 유사한 메뉴 강조 색 사용

## 터미널 출력
- 타임스탬프: `[YYYY-MM-DD HH:MM:SS.mmm]`
- RX/TX 구분 표시, 빈 라인 포함 라인 단위 처리
- TX 명령은 `[TX]` 접두로 로그에 기록

## 로그 파일
- `LOG_DIR` 기준 저장, 미설정 시 디렉토리 선택 후 `.env` 저장
- 파일명: `lnxterm_YYYYMMDD_HHMMSS.log`
- 연결 시 자동 로깅 시작
- 프로그램 실행 후 최초 정해진 로그 파일을 세션 동안 유지
- 재연결 후에도 동일 로그 파일에 append 재개
- 사이드바에 로그 파일 절대 경로 표시/복사

## 문자열 통계 CSV
- 로그 파일 기반으로 통계 CSV 경로 생성
- 열 순서: `문자열, 집계 시점, 누적 카운트, 대소문자 구분, 로그`
- `로그` 열은 매칭된 원문 한 줄 전체 저장
- 로그 파일 경로가 고정되므로 통계 CSV 파일도 세션 동안 동일 파일 유지

## GUI
- 사이드바/터미널 분할 리사이즈
- 상단 연결/해제/클리어 버튼
- 비활성 -> 활성 전환 시 명령 입력창 자동 포커스
- 문자열 카운터 최대 10개
- 자동 명령 추가/편집/삭제/시작/정지
- 자동 명령 제목 길이 정책
  - 최대 40자
  - 표시 시 20자 단위 줄바꿈
- 자동 명령 시작 정책
  - 미연결 상태에서 시작 불가
  - 시작 시 자동 실행되지 않고 사용자 Start 후 동작
- 자동 명령 지연 명령
  - `sleep(ms)` 구문 지원
  - 최대 `99,999,999ms`
- 문자열 통계 시작 정책
  - 미연결 상태에서 시작 불가
- 자주 쓰는 명령어(매크로)
  - 별도 창에서 최대 1000개 등록
  - 항목 정보: 명령어, 설명(200자 제한)
  - 번호 클릭 시 즉시 전송
  - 단축키는 1~10번만 제공
- 검색(Ctrl+F), 하이라이트, 이전/다음 이동

## 배포
- PyInstaller 단일 실행 파일: `dist/lnxterm`
